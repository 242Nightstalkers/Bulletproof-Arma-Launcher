# Section: Screen where install related stuff is

<OptionsButton@HoverButton>
    on_release: app.root.ids.main_screen_manager.current = 'pref_screen'
    text: 'OPTIONS'

<ForumButton@HoverButton>
    text: 'FORUM'

<MakeTorrentButton@HoverButton>
    disabled: True

<NewsLabel@RstDocument>
    size_hint: (None, None)
    colors: {'background': '000000c0', 'link': 'ce5c00ff', 'paragraph': 'eeeeeeff', 'title': 'ffffccff', 'bullet': 'ffffffff'}
    underline_color: 'ffffccff'
    base_font_size: 28

# From Kivy's style.kv
<ProgressBar>:
    canvas:
        Color:
            rgb: 1, 1, 1
        BorderImage:
            border: (12, 12, 12, 12)
            pos: self.x, self.center_y - 9  # 12
            size: self.width, 18  # 24
            #source: 'atlas://data/images/defaulttheme/progressbar_background'
            source: app.resource_path('images/progressbar_background.png')
        BorderImage:
            border: [int(min(self.width * (self.value / float(self.max)) if self.max else 0, 12))] * 4
            pos: self.x, self.center_y - 9  # 12
            size: self.width * (self.value / float(self.max)) if self.max else 0, 18  # 24
            #source: 'atlas://data/images/defaulttheme/progressbar'
            source: app.resource_path('images/progressbar.png')

<InstallScreen>:

    padding: 20
    name: 'install_screen'

    NewsLabel:
        id: news_label

        size: 0, 400
        right: root.right - 30
        top: root.top - 50

    Image:
        source: app.resource_path('images/logo.png')
        pos: 40, root.top - self.height
        size_hint: None, None
        size: self.texture_size

#= Menu ========================================================================

    ProgressBar:
        id: progress_bar
        value: 0
        height: 18
        y: status_box.height
        size_hint_y: None

    Label:
        id: status_label
        text: ''
        x: progress_bar.x + 40
        y: progress_bar.y

        size: self.texture_size
        size_hint: None, None
        text_size: progress_bar.size
        outline_width: 2
        valign: 'middle'


    # Horizontal gray bar
    LabelB:
        y: status_box.y
        height: status_box.height
        bcolor: 0.12, 0.12, 0.12, 1
        size_hint_y: None

    # Horizontal orange bar
    LabelB:
        pos: status_box.right, status_box.y
        size: root.width - status_box.right, status_box.height
        bcolor: 1, 0.7, 0.2, 1
        size_hint: None, None

    # Status box with the messages
    Label:
        id: status_box
        y: 0
        height: 65
        width: 720
        size_hint: None, None
        padding: 40, 5
        halign: 'left'
        valign: 'top'
        text_size: self.size
        italic: True
        color: 0.7, 0.7, 0.7, 1

    StatusImage:
        id: status_image
        source_map: { 'default': app.resource_path('images/loader.zip'), 'attention': app.resource_path('images/achtung40x38.png') }
        pos: progress_bar.pos
        size: progress_bar.height, progress_bar.height
        size_hint: None, None
        hidden: True

#= Buttons =====================================================================

    # Vertical buttons
    StackLayout:
        y: status_box.top
        x: status_box.right
        width: 246
        size_hint_x: None
        #size_hint_y: 0
        orientation: 'bt-lr'
        spacing: 8
        padding: 0, 8 + progress_bar.height

        OptionsButton:
            id: options_button
            size_hint_x: 1
            disabled: True

        ForumButton:
            size_hint_x: 1
            on_release: root.controller.on_forum_button_release(self)

        MakeTorrentButton:
            background_color: 0, 0, 0, 0
            size_hint_x: 1
            id: make_torrent
            on_release: root.controller.on_make_torrent_button_release(self)

    # Install/Play/More button
    BoxLayout:
        pos: status_box.right, 0
        width: root.width - status_box.width
        height: status_box.height
        size_hint_y: None


        DynamicButton:
            id: action_button
            disabled: True
            # on_release callbacks are bound in installscreen.py
            text: 'INSTALL'
            font_size: 40
            size_hint_y: 1

            color_normal: [0, 0, 0, 1]
            bgcolor_normal: [1, 0.7, 0.2, 1]
            bgcolor_hover: [1, 0.8, 0.3, 1]

            padding: 30, 0

        # This button must be created after the PLAY button so that it is on top of it
        MorePlayButton:
            alpha: 0
            id: more_play
            font_size: 40
            font_name: app.resource_path("fonts/Equality.ttf")
            size_hint_y: 1
            on_release: root.controller.on_more_play_button_release(self)
            disabled: True,
            pos_hint: {'right': 1}

            color_normal: [0, 0, 0, 1]
            bgcolor_normal: [1, 0.7, 0.2, 1]
            bgcolor_hover: [1, 0.8, 0.3, 1]

#= Other =======================================================================

    # Version number
    Label:
        id: footer_label
        text: 'Build: N/A'
        font_name: app.resource_path("fonts/Myriad_Pro_Regular.ttf")
        font_size: 12
        outline_width: 1

        size: self.texture_size
        color: 0.5, 0.5, 0.5, 0.5
        padding: [20, 20]
        size_hint: None, None
        pos_hint: {'right': 1, 'top': 1}
